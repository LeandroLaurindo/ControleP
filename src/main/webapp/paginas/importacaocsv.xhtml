<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./layoutPadrao.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html">

    <ui:define name="importa" id="importa">
        <p:panel>
            <f:view>
                <h:form enctype="multipart/form-data">
                    <p:fieldset legend="Importar Telelefones">
                    <p:fileUpload value="#{controleImportacaoCSV.filess}" label="Click aqui para escolher"
                                  id="fileUpload2" mode="simple" skinSimple="true" />
                    <p:commandButton value="Enviar" styleClass="botao" ajax="false"
                                     actionListener="#{controleImportacaoCSV.importar()}" style="margin-top: 10px; font-size: 20px; padding: 5px;"/>
                    </p:fieldset>
                </h:form>
            </f:view>
            
             <f:view>
                <h:form enctype="multipart/form-data">
                    <p:fieldset legend="Importar Clientes">
                    <p:fileUpload value="#{controleImportacaoCSV.filess}" label="Click aqui para escolher"
                                  id="fileUpload3" mode="simple" skinSimple="true" />
                    <p:commandButton value="Enviar" styleClass="botao" ajax="false"
                                     actionListener="#{controleImportacaoCSV.prepararDados()}" style="margin-top: 10px; font-size: 20px; padding: 5px;"/>
                    </p:fieldset>
                </h:form>
            </f:view>
            <f:view>

                <h:form>
                    <p:dataTable value="#{controleImportacaoCSV.listaDeDados}" var="item" widgetVar="pausaTable" paginator="true"
                                 emptyMessage="Nenhum usuário encontrado!" currentPageReportTemplate="(Pag. {currentPage}/{totalPages} - {totalRecords} registros)"
                                 rows="10" rowsPerPageTemplate="5,10,15,#{controleImportacaoCSV.listaDeDados.size()}"
                                 sortBy="#{item.numero}">
                        <f:facet name="header">
                            <h3>Lista de Telefones</h3>
                        </f:facet>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Id"/>
                            </f:facet>
                            <h:outputText value="#{item.id}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Numero"/>
                            </f:facet>
                            <h:outputText value="#{item.numero}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Operadora"/>
                            </f:facet>
                            <h:outputText value="#{item.operadora}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Nome"/>
                            </f:facet>
                            <h:outputText value="#{item.nome}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="DataPortabilidade"/>
                            </f:facet>
                            <h:outputText value="#{item.dataPortabilidade}">
                                <f:convertDateTime pattern="yyyy/dd/MM HH:mm:ss" />
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </h:form>
            </f:view>

            <f:view>
                <h:form id="frmLigacao">
                    <p:dialog header="Atenção ao ligar ligar as colunas" widgetVar="dlgLigacao">
                        <h:dataTable value="#{controleImportacaoCSV.listaColulasPlanilha}" var="item">
                            <p:column headerText="Associação de campos">
                                <h:outputText value="#{item.coluna}" style="size: 20px;" />
                                <h:outputText value="==>" />
                                <p:selectOneMenu id="colunaTabela" value="#{controleImportacaoCSV.nomeColuna}">
                                    <!-- TODO: update below reference to list of available items-->
                                    <p:ajax  process="colunaTabela" event="change" listener="#{controleImportacaoCSV.metodoDeAssociacao(item.indice)}"/>
                                    <f:selectItems value="#{controleImportacaoCSV.listaColunasCliente}" var="cli" itemLabel="#{cli}" itemValue="#{cli}"/>
                                </p:selectOneMenu>
                            </p:column>
                        </h:dataTable>
                        <p:commandButton value="Importar" actionListener="#{controleImportacaoCSV.importarCliente()}" class="botao" />
                    </p:dialog>
                </h:form>
            </f:view>
            
        </p:panel>
    </ui:define>

</ui:composition>
